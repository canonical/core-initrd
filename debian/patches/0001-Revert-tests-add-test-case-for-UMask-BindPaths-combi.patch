From b368907b3e978f6909991d17cbe23035a6a8110b Mon Sep 17 00:00:00 2001
From: Lukas MÃ¤rdian <slyon@ubuntu.com>
Date: Tue, 25 Jan 2022 16:13:22 +0100
Subject: [PATCH] Revert "tests: add test case for UMask=+BindPaths=
 combination"

This test currently fails inside privileged LXD containers (LP: #1959013)

This reverts commit ae53f4b5e48860b473c4d05958486a77f84ecc6d.
---
 src/test/test-execute.c                        |  5 -----
 test/test-execute/exec-umask-namespace.service | 12 ------------
 2 files changed, 17 deletions(-)
 delete mode 100644 test/test-execute/exec-umask-namespace.service

--- a/src/test/test-execute.c
+++ b/src/test/test-execute.c
@@ -1142,16 +1142,6 @@
         test_service(m, "exec-condition-skip.service", SERVICE_SKIP_CONDITION);
 }
 
-static void test_exec_umask_namespace(Manager *m) {
-        /* exec-specifier-credentials-dir.service creates /run/credentials and enables implicit
-         * InaccessiblePath= for the directory for all later services with mount namespace. */
-        if (!is_inaccessible_available()) {
-                log_notice("Testing without inaccessible, skipping %s", __func__);
-                return;
-        }
-        test(m, "exec-umask-namespace.service", can_unshare ? 0 : EXIT_NAMESPACE, CLD_EXITED);
-}
-
 typedef struct test_entry {
         test_function_t f;
         const char *name;
@@ -1234,7 +1224,6 @@
                 entry(test_exec_specifier),
                 entry(test_exec_execsearchpath_specifier),
                 entry(test_exec_systemcallfilter_system),
-                entry(test_exec_umask_namespace),
                 {},
         };
         int r;
--- a/test/test-execute/exec-umask-namespace.service
+++ /dev/null
@@ -1,12 +0,0 @@
-# SPDX-License-Identifier: LGPL-2.1-or-later
-[Unit]
-Description=Test for UMask= + namespacing
-
-[Service]
-ExecStart=/bin/ls -lahd /tmp/subdir
-Type=oneshot
-User=65534
-Group=65534
-TemporaryFileSystem=/tmp:ro
-BindPaths=/etc:/tmp/subdir/subsub
-UMask=0007
